<div class="container-fluid">
  <div class="card" style="border:0;border-radius:0">
    <div class="card-header" id="maincard">
      Company
    </div>
    <div class="card-body">
      <div *ngIf='!viewFlag' class="new">
        <div class="row">
          <div class="col-sm-3">
            <mat-form-field class="example-full-width">
              <input [(ngModel)]="model.CompanyName" name="CompanyName" required matInput
                placeholder="Name of the company">
              <mat-error> Nameofthecompany required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.CountryId" name="CountryId"
                (ngModelChange)="getState(model.CountryId)" placeholder="Select Country">
                <mat-option *ngFor="let i of countryData" [value]="i.CountryId">{{i.CountryName}}
                </mat-option>
              </mat-select>
              <mat-error> Country required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.StateId" name="StateId" placeholder="Select State"
                (ngModelChange)="getCity(model.StateId)">
                <mat-option *ngFor="let i of stateData" [value]="i.StateId">{{i.StateName}}
                </mat-option>
              </mat-select>
              <mat-error> StateName required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.CityId" name="CityId" placeholder="Select City"
                (ngModelChange)="getArea(model.CityId)">
                <mat-option *ngFor="let i of cityData" [value]="i.CityId">{{i.CityName}}
                </mat-option>
              </mat-select>
              <mat-error> CityName required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.AreaId" name="AreaId" placeholder="Select Area">
                <mat-option *ngFor="let i of areaData" [value]="i.AreaId">{{i.AreaName}}
                </mat-option>
              </mat-select>
              <mat-error> AreaName required</mat-error>
            </mat-form-field>

          </div>
          <div class="col-sm-3">

            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.Pincode" name="PinCode" matInput placeholder="PinCode">
              <mat-error> PinCode required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.ParentCompany" name="ParentCompany"
                placeholder="Reporting Company">
                <mat-option *ngFor="let i of companyData" [value]="i.CompanyId">{{i.CompanyName}}
                </mat-option>

              </mat-select>
              <mat-error> Reporting Company required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.CompanyCode" name="CompanyCode" matInput placeholder="CompanyCode">
              <mat-error> CompanyCode required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.AddressLine1" name="AddressLine1" matInput placeholder="Addrees Line1">
              <mat-error> AddreesLine1 required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.AddressLine2" name="AddressLine2" matInput placeholder="Addrees Line2">
              <mat-error> AddreesLine2 required</mat-error>
            </mat-form-field>
          </div>
          <div class="col-sm-3">

            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.Email" name="Email" matInput placeholder="Company Email">
              <mat-error> Company Email required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required matInput [(ngModel)]="model.Website" name="Website" placeholder="Website"
                (keypress)="urlValidation($event)">
              <mat-error> Website required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.PhoneNo" name="PhoneNo" matInput placeholder="phone no">
              <mat-error> phoneno required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <input required [(ngModel)]="model.FaxNo" name="FaxNo" matInput placeholder="Fax No">
              <mat-error> FaxNo required</mat-error>
            </mat-form-field>
            <br> <br>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.OrganizationLevelId" name="OrganizationLevelId"
                placeholder="Organization Level">
                <mat-option *ngFor="let i of organizationLevelData" [value]="i.OrganizationLevelId">
                  {{i.LevelName}}
                </mat-option>
              </mat-select>
              <mat-error> OrganizationLevel required</mat-error>
            </mat-form-field>
          </div>
          <div class="col-sm-3">
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.TypeId" name="TypeId" placeholder="Type of organization">
                <mat-option *ngFor="let i of organizationTypesData" [value]="i.TypeId">{{i.OwnershipName}}
                </mat-option>
              </mat-select>
              <mat-error> Type of organization required</mat-error>
            </mat-form-field>
            <br>
            <div>
              <label class="example-margin" style="font-size:12px">ImageUpload:</label>
              <br>
              <img *ngIf="photoFlag" [src]="API_URL + '/UploadFile/'+ model.CompanyLogo" style="width: 150px;height: 150px;">
              <img *ngIf="!photoFlag" [src]="API_URL + '/UploadFile/'+ model.CompanyLogo" style="width: 150px;height: 150px;">
              <br>
              <input type="file" [(ngModel)]="CompanyLogo" (change)="uploadImage($event)" style="font-size:12px;margin-top: 14px;" required placeholder="ImageUpload"><br><br>
            </div>
            <mat-form-field class="example-full-width">
              <mat-select required [(ngModel)]="model.BusinessId" name="BusinessId" placeholder="Nature Of Business">
                <mat-option *ngFor="let i of natureOfBusinessData" [value]="i.BusinessId">
                  {{i.BusinessName}}
                </mat-option>
              </mat-select>
              <mat-error> Nature Of Business required</mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="col-sm-12" style="text-align: right">
            <div class="matbutton">
              <button *ngIf="!isEditing" mat-raised-button color="primary" (click)="saveCompanyInitiation()">Save</button>
              <button *ngIf="isEditing" mat-raised-button color="primary"
                (click)="saveCompanyInitiation()">Update</button>&nbsp;
              <button (click)="onNewClick()" mat-raised-button color="warn">Cancel</button>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf='viewFlag' class="list">
        <div class="row" style="margin-top:3%">
          <div class="col-sm-8" style="padding-left:30px">
            <div class="input-group ht-41">
              <div class="input-group-prepend">
                <span class="input-group-text input-group-empty">
                  <i class="fa fa-search"></i>
                </span>
              </div>
              <input type="text" class="form-control text-box-empty"
                placeholder="Global Filter (Type code,NameOfCompany,TypeOfOrganization..)"
                (keyup)="applyFilter($event.target.value)">
            </div>
          </div>
          <div class="col-sm-4" style="text-align:right;padding-right:30px">
            <button mat-raised-button (click)="onNewClick()" color="accent">
              <mat-icon>add</mat-icon>New
            </button>
          </div>
        </div>
        <br>

        <!--/ table start-->
        <div class="col-lg-12 col-md-12">
          <!--/ table start-->
          <div class="table-container mat-elevation-z2">
            <mat-table class="color-table" #table [dataSource]="dataSource" matSort>

              <ng-container matColumnDef="SNo">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  SNo
                  <button mat-icon-button [matMenuTriggerFor]="SNoFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="SNo Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #SNoFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search SNo" (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element;let i=index"> {{i+1}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="CompanyCode">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  CompanyCode
                  <button mat-icon-button [matMenuTriggerFor]="EmpFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="Area Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #EmpFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search CompanyCode." (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.CompanyCode}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="CompanyName">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  CompanyName
                  <button mat-icon-button [matMenuTriggerFor]="CompanyNameFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="Phone Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #CompanyNameFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search CompanyName." (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.CompanyName}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="LevelName">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  TypeOfOrganization
                  <button mat-icon-button [matMenuTriggerFor]="ReportingToFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="Phone Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #ReportingToFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search LevelName." (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.OrganizationLevel.LevelName}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="ReportingTo">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  ReportingTo
                  <button mat-icon-button [matMenuTriggerFor]="ReportingToFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="Phone Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #ReportingToFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search ReportingTo." (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.ParentCompanyName}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="CityName">
                <mat-header-cell *matHeaderCellDef mat-sort-header class="inFilter color-white">
                  Location
                  <button mat-icon-button [matMenuTriggerFor]="LocationFilter" class="Filter-icon-WT">
                    <mat-icon aria-label="Phone Filter">keyboard_arrow_down</mat-icon>
                  </button>
                  <mat-menu #LocationFilter="matMenu" yPosition="below" [overlapTrigger]="false" xPosition="before">
                    <div class="info-wrapper menuPop">
                      <mat-form-field class="w-100 input-label">
                        <input matInput placeholder="Search Location" (click)="handleClick($event)"
                          (keyup)="applyFilter($event.target.value)" autofocus>
                      </mat-form-field>
                      <div class="ta-w">
                        <button mat-mini-fab color="warn" class="satPop-ok">
                          <mat-icon aria-label="Close">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </mat-menu>
                </mat-header-cell>
                <mat-cell *matCellDef="let element"> {{element.City.CityName}} </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Action">
                <mat-header-cell *matHeaderCellDef class="color-white">Action</mat-header-cell>
                <mat-cell *matCellDef="let element">
                  <button mat-icon-button color="primary" matTooltip="Edit This Row" (click)="editCompany(element)"
                    [matTooltipClass]="'custom-tip'">
                    <mat-icon aria-label="Edit Row" class="f-18">
                      edit
                    </mat-icon>
                  </button>
                  <button mat-icon-button color="warn" (click)="RemoveCompany(element)" matTooltip="Delete This Row"
                    [matTooltipClass]="'custom-tip'">
                    <mat-icon aria-label="Add" class="f-18">delete</mat-icon>
                  </button>
                </mat-cell>
              </ng-container>

              <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
              <mat-row *matRowDef="let row;let i=index; columns: displayedColumns;" (click)="selection.toggle(row)">
              </mat-row>
            </mat-table>

            <mat-paginator #paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" [showFirstLastButtons]="true">
            </mat-paginator>
          </div>
          <!--/ table start-->
        </div>
      </div>
    </div>
  </div>
</div>